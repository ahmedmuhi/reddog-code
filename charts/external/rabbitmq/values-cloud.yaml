# RabbitMQ 4.2.0 cloud baseline (Bitnami chart)
#
# Usage:
#   helm upgrade --install rabbitmq oci://registry-1.docker.io/bitnamicharts/rabbitmq \
#     --namespace rabbitmq --create-namespace \
#     -f charts/external/rabbitmq/values-cloud.yaml
#
# Secrets referenced here are defined in `manifests/cloud/secrets/rabbitmq-secrets.template.yaml`.

global:
  storageClass: premium-ssd

image:
  repository: docker.io/bitnami/rabbitmq
  tag: 4.2.0-debian-12-r0
  pullPolicy: IfNotPresent

auth:
  username: reddog-admin
  existingPasswordSecret: rabbitmq-shared-credentials
  existingPasswordSecretKey: password
  existingErlangSecret: rabbitmq-erlang-cookie

tls:
  enabled: true
  failIfNoPeerCert: true
  existingSecret: rabbitmq-tls

clustering:
  enabled: true
  forceBoot: true
  rebalance: true

replicaCount: 3

resources:
  requests:
    cpu: 250m
    memory: 512Mi
  limits:
    cpu: 1000m
    memory: 1Gi

persistence:
  enabled: true
  storageClass: premium-ssd
  size: 20Gi

metrics:
  enabled: true
  serviceMonitor:
    enabled: true

extraConfiguration: |
  log.console = true
  management.load_definitions = /app/load_definition.json
  feature_flags.default = khepri_db
  queue_master_locator = min-masters

definitionsSource: secret
definitionsSecret: rabbitmq-load-definitions

podAnnotations:
  prometheus.io/scrape: "true"
  prometheus.io/port: "15692"

nodeSelector:
  kubernetes.io/os: linux
